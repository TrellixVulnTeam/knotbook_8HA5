![KnotBook Icon](tools/assets/knot-small.png)

|Platform|Build Status|
|----|----|
|Windows|[![Build Status](https://dev.azure.com/yuliu2016/knotbook/_apis/build/status/yuliu2016.knotbook?branchName=master&jobName=Windows)](https://dev.azure.com/yuliu2016/knotbook/_build/latest?definitionId=1&branchName=master)|
|MacOS|[![Build Status](https://dev.azure.com/yuliu2016/knotbook/_apis/build/status/yuliu2016.knotbook?branchName=master&jobName=MacOS)](https://dev.azure.com/yuliu2016/knotbook/_build/latest?definitionId=1&branchName=master)|
|Linux|[![Build Status](https://dev.azure.com/yuliu2016/knotbook/_apis/build/status/yuliu2016.knotbook?branchName=master&jobName=Linux)](https://dev.azure.com/yuliu2016/knotbook/_build/latest?definitionId=1&branchName=master)|

**KnotBook** is a **JavaFX** data viewing/analysis app for FRC, successor
to the [2019 app](https://github.com/Team865/Restructured-Tables).
It is written with JDK 11 with modules and uses OpenJFX 13. Instead of of using
launch4j to generate singular executables, it uses jlink to create a complete runtime.

JDK 11 is required to build/run

To build: `gradlew build`

To run application: `gradlew run`

To generate a runtime image: `gradlew jlink`

The runtime image is automatically generated by Azure Pipelines for Windows, Ubuntu,
and MacOS; they can be downloaded from the build status table above.
See [azure-pipelines.yml](azure-pipelines.yml). A WIP python script for installing
the packages is found at [installer-v2.py](tools/kbpy/scripts/installer-v2.py)

With the early-access builds of `jpackage`, a complete native application
can be generated based on the jlink tool above. Not included right now because 
the tool is in a very early state and would hard to automate.

#### Components

**Bowline**: 
ControlsFX SpreadsheetView is not supported since JDK 9.
Bowline a custom table Control with its own
VirtualFlow implementation. 
See [GridVirtualFlow.kt](modules/kb.core.bowline/src/main/kotlin/kb/core/bowline/GridVirtualFlow.kt)
for details on how it works.
It is currently WIP.

**Camera**:
A JavaFX image window to display the webcam and read QR codes. See
[KnotCamera.java](modules/kb.core.camera.fx/src/main/java/kb/core/camera/fx/KnotCamera.java)

**Path Planner**:
A rewrite of the Processing version of path planner from 2019

#### Special Notes: 
The webcam-capture library is unable to load the native files in the modules in development mode,
likely due to Java 9+ modularization. As a workaround, we need to find `OpenIMAJGrabber.dll`
(or another extension for another system) and put it on the PATH so that BridJ can find it.
It seems to work in the jlink image

The javamodularity gradle plugin is not fully stable and caches things incorrectly.
Some gradle tasks fail and require either running `gradlew clean` or just re-running them. 
They are usually fixed after that